 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
name: Readiness Poller & Notifier

# Runs on a schedule and on-demand. The job runs the repo readiness checker,
# posts a summary to Slack, and upserts a comment on all open PRs.
on:
  schedule:
    # Daily at 08:00 UTC (adjust as needed)
    - cron: '0 8 * * *'
  workflow_dispatch: {}

jobs:
  poll-and-notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y jq curl

      - name: Make notifier executable
        run: |
          chmod +x scripts/repo_readiness_check.sh
          chmod +x scripts/post_readiness_to_slack_and_prs.sh

      - name: Run readiness poller and notify
        env:
          # Slack webhook should be stored in repo/organization secrets
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          # GITHUB_TOKEN is provided automatically by Actions; keep it for API calls
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # GITHUB_REPOSITORY is provided by Actions runtime
        run: |
          ./scripts/post_readiness_to_slack_and_prs.sh
.github/workflows/readiness_poller.yml
