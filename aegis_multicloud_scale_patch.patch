*** Begin Patch
*** Add File: scripts/azure_finalize_setup.sh
+#!/usr/bin/env bash
+#
+# Finalize Azure setup for Aegis:
+#  - create resource group, ACR, Storage Account & container (if not present)
+#  - create Azure AD App (if requested) and federated credential to bind k8s SA (Workload Identity)
+#  - push trainer image to ACR
+#
+# Usage:
+#   AZ_SUBSCRIPTION=<sub> AZ_RG=<rg> AZ_REGION=<region> \
+#     ACR_NAME=<acr> STORAGE_ACCOUNT=<sa> STORAGE_CONTAINER=<container> \
+#     K8S_NAMESPACE=aegis K8S_SA=aegis-trainer \
+#     ./scripts/azure_finalize_setup.sh
+set -euo pipefail
+
+AZ_SUBSCRIPTION="${AZ_SUBSCRIPTION:-$(az account show --query id -o tsv)}"
+AZ_RG="${AZ_RG:-aegis-rg}"
+AZ_REGION="${AZ_REGION:-eastus}"
+ACR_NAME="${ACR_NAME:-aegisacr}"
+STORAGE_ACCOUNT="${STORAGE_ACCOUNT:-aegisstorage$(date +%s | rev | cut -c1-6 | rev)}"
+STORAGE_CONTAINER="${STORAGE_CONTAINER:-model-artifacts}"
+K8S_NAMESPACE="${K8S_NAMESPACE:-aegis}"
+K8S_SA="${K8S_SA:-aegis-trainer}"
+AAD_APP_NAME="${AAD_APP_NAME:-aegis-wi-app}"
+
+echo "Using subscription: $AZ_SUBSCRIPTION"
+az account set --subscription "$AZ_SUBSCRIPTION"
+
+echo "Creating resource group $AZ_RG in $AZ_REGION"
+az group create -n "$AZ_RG" -l "$AZ_REGION" >/dev/null
+
+echo "Creating ACR $ACR_NAME (if missing)"
+az acr show -n "$ACR_NAME" -g "$AZ_RG" >/dev/null 2>&1 || az acr create -n "$ACR_NAME" -g "$AZ_RG" --sku Standard -l "$AZ_REGION"
+
+echo "Creating storage account $STORAGE_ACCOUNT"
+az storage account show -n "$STORAGE_ACCOUNT" -g "$AZ_RG" >/dev/null 2>&1 || \
+  az storage account create -n "$STORAGE_ACCOUNT" -g "$AZ_RG" -l "$AZ_REGION" --sku Standard_LRS
+
+echo "Obtaining storage key and creating container $STORAGE_CONTAINER"
+ST_KEY=$(az storage account keys list -n "$STORAGE_ACCOUNT" -g "$AZ_RG" --query '[0].value' -o tsv)
+az storage container create --name "$STORAGE_CONTAINER" --account-name "$STORAGE_ACCOUNT" --account-key "$ST_KEY" >/dev/null
+
+echo "Ensure kubectl context points to target cluster and namespace exists"
+kubectl create namespace "$K8S_NAMESPACE" --dry-run=client -o yaml | kubectl apply -f -
+
+echo "Create k8s serviceaccount $K8S_SA"
+kubectl -n "$K8S_NAMESPACE" create serviceaccount "$K8S_SA" --dry-run=client -o yaml | kubectl apply -f -
+
+echo "Create Azure AD App for workload identity & federated credential"
+AAD_APP_ID=$(az ad app list --display-name "$AAD_APP_NAME" --query '[0].appId' -o tsv || true)
+if [ -z "$AAD_APP_ID"](#)
î€€
