*** Begin Patch
*** Add File: k8s/gatekeeper_constrainttemplate_suggestedaction_strict.yaml
+apiVersion: templates.gatekeeper.sh/v1beta1
+kind: ConstraintTemplate
+metadata:
+  name: aegissuggestedactionpolicy.strict
+spec:
+  crd:
+    spec:
+      names:
+        kind: AegisSuggestedActionPolicyStrict
+  targets:
+    - target: admission.k8s.gatekeeper.sh
+      rego: |
+        package aegis.suggestedaction.strict
+
+        # Parameter names
+        owner_ann := input.parameters.owner_annotation
+        approved_ann := input.parameters.approved_annotation
+        auto_allowed_ann := input.parameters.auto_allowed_annotation
+        high_risk := input.parameters.high_risk_actions
+        forbidden := input.parameters.forbidden_actions
+
+        is_suggestedaction {
+          input.review.kind.kind == "SuggestedAction"
+        }
+
+        # helpers to read common field variants
+        obj := input.review.object
+
+        get_action_name[a] {
+          obj.spec.action == a
+        }
+        get_action_name[a] {
+          obj.spec.type == a
+        }
+
+        is_dryrun {
+          obj.spec.dryRun == true
+        }
+        is_dryrun {
+          obj.spec.dry_run == true
+        }
+
+        has_owner {
+          obj.metadata.annotations[owner_ann] != ""
+        }
+
+        is_approved {
+          obj.metadata.annotations[approved_ann] == "true"
+        }
+
+        auto_allowed {
+          # Annotation that a specific SuggestedAction is allowed to be auto-executed
+          obj.metadata.annotations[auto_allowed_ann] == "true"
+        }
+
+        # Deny create if missing owner annotation
+        violation[{"msg": msg}] {
+          is_suggestedaction
+          input.review.operation == "CREATE"
+          not has_owner
+          msg := sprintf("Missing required annotation '%v' (owner) on SuggestedAction", [owner_ann])
+        }
+
+        # Deny any action that is explicitly forbidden
+        violation[{"msg": msg}] {
+          is_suggestedaction
+          input.review.operation == "CREATE"
+          get_action_name[action]
+          some i
+          forbidden[i] == action
+          msg := sprintf("Action '%v' is forbidden by cluster policy", [action])
+        }
+
+        # High-risk actions require dryRun OR explicit approval
+        violation[{"msg": msg}] {
+          is_suggestedaction
+          input.review.operation == "CREATE"

î€€aw
