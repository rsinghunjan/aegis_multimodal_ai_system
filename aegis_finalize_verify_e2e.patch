*** Begin Patch
*** Add File: scripts/package_and_attest_rekor_canonical.sh
+#!/usr/bin/env bash
+#
+# Canonical packaging + cosign sign (keyless preferred) + Rekor UUID capture.
+# Writes a DSSE-like attestation that always contains rekor_uuid (empty if none).
+#
+# Requirements:
+#  - cosign (for sign-blob / keyless)
+#  - jq, openssl, curl, awscli
+#
+# Usage:
+#  REKOR_URL=https://rekor.example.com OBJECT_STORE_BUCKET=... ./scripts/package_and_attest_rekor_canonical.sh <model_dir> <artifact_out>
+set -euo pipefail
+
+MODEL_DIR="${1:-}"
+OUT_TAR="${2:-}"
+
+if [ -z "$MODEL_DIR" ] || [ -z "$OUT_TAR" ]; then
+  echo "Usage: $0 <model_dir> <artifact_out>"
+  exit 2
+fi
+if [ ! -d "$MODEL_DIR" ]; then
+  echo "Model dir not found: $MODEL_DIR" >&2
+  exit 3
+fi
+
+TMP=$(mktemp -d)
+trap 'rm -rf "$TMP"' EXIT
+
+echo "Creating deterministic archive..."
+if [ -x scripts/make_deterministic_archive.py ]; then
+  python3 scripts/make_deterministic_archive.py "$MODEL_DIR" "$OUT_TAR"
+else
+  find "$MODEL_DIR" -type f | sort > "$TMP/files.lst"
+  tar --sort=name --mtime='UTC 2020-01-01' -czf "$OUT_TAR" -T "$TMP/files.lst"
+fi
+
+HEX_DIGEST=$(openssl dgst -sha256 -binary "$OUT_TAR" | xxd -p -c 256)
+BASE64_DIGEST=$(openssl dgst -sha256 -binary "$OUT_TAR" | base64 -w0)
+SIG_JSON="${OUT_TAR}.sig.json"
+ATTEST="${OUT_TAR}.attestation.json"
+REKOR_UUID=""
+
+echo "Attempt cosign keyless sign-blob -> signature file"
+if command -v cosign >/dev/null 2>&1; then
+  set +e
+  cosign sign-blob --output-signature "$TMP/sig.b64" --keyless "$OUT_TAR" >"$TMP/cosign.out" 2>&1
+  COSIGN_RC=$?
+  set -e
+  if [ $COSIGN_RC -eq 0 ] && [ -f "$TMP/sig.b64" ]; then
+    base64 -d "$TMP/sig.b64" > "$TMP/sig.bin" || true
+    SIG_B64=$(base64 -w0 "$TMP/sig.bin" || true)
+    jq -n --arg s "$SIG_B64" '{data:{signature:$s}}' > "$SIG_JSON"
+    echo "cosign signature saved -> $SIG_JSON"
+    # Query Rekor index for canonical entry (if REKOR_URL set)
+    if [ -n "${REKOR_URL:-}" ]; then
+      QUERY="${REKOR_URL%/}/api/v1/index/retrieve?hash=sha256:${HEX_DIGEST}"
+      echo "Query Rekor index: $QUERY"
+      REKOR_RESP=$(curl -sS "$QUERY" || true)
+      if [ -n "$REKOR_RESP" ] && [ "$REKOR_RESP" != "null" ]; then
+        REKOR_UUID=$(echo "$REKOR_RESP" | jq -r 'keys[0]' 2>/dev/null || true)
+        [ "$REKOR_UUID" = "null" ] && REKOR_UUID=""
+        if [ -n "$REKOR_UUID" ]; then
+          echo "Found Rekor UUID: $REKOR_UUID"
+        else
+          echo "No Rekor UUID found for digest (cosign may not have uploaded or Rekor delayed)."
+        fi
+      else
+        echo "Rekor index query empty/null"
+      fi
+    fi
+  else
+    echo "cosign keyless sign-blob failed (not available or OIDC not configured). See $TMP/c](#)
î€€
