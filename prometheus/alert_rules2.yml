  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
groups:
  - name: aegis-slo-rules
    rules:
      - alert: HighPredictionLatency
        expr: histogram_quantile(0.95, sum(rate(aegis_prediction_latency_ms_bucket[5m])) by (le, model, version)) > 1000
        for: 5m
        labels:
          severity: page
        annotations:
          summary: "High P95 prediction latency ({{ $labels.model }}:{{ $labels.version }})"
          description: "P95 latency > 1000ms for 5m"

      - alert: HighErrorRate
        expr: sum(rate(http_requests_total{job=\"aegis_api\",status=~\"5..\"}[5m])) / sum(rate(http_requests_total{job=\"aegis_api\"}[5m])) > 0.05
        for: 5m
        labels:
          severity: page
        annotations:
          summary: "High 5xx error rate on API"
          description: "More than 5% errors (5xx) in the last 5 minutes"

      - alert: OTelCollectorDown
        expr: up{job=\"otel_collector\"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "OTel collector down"
          description: "Check collector container and OTLP ingestion"
