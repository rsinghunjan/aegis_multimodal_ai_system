  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
global:
  resolve_timeout: 5m
route:
  # default route
  receiver: "slack-notifications"
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 1h
  routes:
    - receiver: "pagerduty-pager"
      match:
        severity: "page"
      continue: false
    - receiver: "slack-notifications"
      match_re:
        severity: "warning|critical"
      continue: false

receivers:
  - name: "slack-notifications"
    slack_configs:
      - send_resolved: true
        channel: "{{ .CommonLabels.slack_channel | default \"#alerts\" }}"
        api_url: "https://hooks.slack.com/services/REPLACE/ME/REPLACE" # replace via secret mount or SecretManager
        title: "[{{ .Status }}] {{ .CommonLabels.alertname }}"
        text: >
          *Alert:* {{ .CommonLabels.alertname }}
          *Severity:* {{ .CommonLabels.severity }}
          *Instance:* {{ .CommonLabels.instance }}
          {{ range .Alerts }}*Summary:* {{ .Annotations.summary }}{{ end }}

  - name: "pagerduty-pager"
    pagerduty_configs:
      - send_resolved: true
        service_key: "REPLACE_WITH_PAGERDUTY_INTEGRATION_KEY" # store in secret
        severity: critical

inhibit_rules:
  - source_match:
      severity: "page"
    target_match:
      severity: "warning"
    equal:
      - alertname
templates: []
