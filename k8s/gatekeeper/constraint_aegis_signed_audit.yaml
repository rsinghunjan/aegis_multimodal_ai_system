
apiVersion: constraints.gatekeeper.sh/v1beta1
kind: AegisSignedPod
metadata:
  name: require-aegis-signed-audit
spec:
  enforcementAction: dryrun   # audit/dry-run mode: reports violations but does not deny admission
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
    # You can scope by namespace here (e.g., protect 'aegis' and 'prod' initially)
    namespaces:
      - "aegis"
      - "prod"
  parameters:
    # list of namespaces the Rego will check (keeps Rego generic)
    namespaces:
      - "aegis"
      - "prod"
