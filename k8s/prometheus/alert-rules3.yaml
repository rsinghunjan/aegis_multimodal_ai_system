  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: aegis-canary-rules
  namespace: aegis
spec:
  groups:
  - name: aegis-canary.rules
    rules:
    - alert: AegisCanaryErrorRateHigh
      expr: rate(aegis_model_inference_errors_total[5m]) > 0.01
      for: 2m
      labels:
        severity: critical
      annotations:
        summary: "Canary error rate high for Aegis model"
        description: "Canary has error rate > 1% for 5m - trigger rollback"
    - alert: AegisCanaryLatencyHigh
      expr: histogram_quantile(0.95, sum(rate(aegis_model_inference_latency_ms_bucket[5m])) by (le)) > 500
      for: 2m
      labels:
        severity: warning
      annotations:
        summary: "Canary p95 latency high"
        description: "The canary p95 latency exceeds 500ms"
k8s/prometheus/alert-rules.yaml
