*** Begin Patch
*** Add File: scripts/vault_rotate_to_k8s.sh
+#!/usr/bin/env bash
+#
+# Rotate secrets from Vault into Kubernetes Secrets (idempotent).
+# Usage:
+#   ./scripts/vault_rotate_to_k8s.sh --vault-path secret/data/aegis/ci --k8s-secret aegis-ci-token --namespace aegis [--dry-run]
+#
+# Behavior:
+#  - reads secret fields from Vault kv v2 path (must have vault CLI logged in)
+#  - creates/patches a k8s secret with same keys
+#  - supports --dry-run to show payload without applying
+set -euo pipefail
+
+VAULT_PATH=""
+K8S_SECRET=""
+NAMESPACE="aegis"
+DRY_RUN=false
+
+while [[ $# -gt 0 ]]; do
+  case "$1" in
+    --vault-path) VAULT_PATH="$2"; shift 2 ;;
+    --k8s-secret) K8S_SECRET="$2"; shift 2 ;;
+    --namespace) NAMESPACE="$2"; shift 2 ;;
+    --dry-run) DRY_RUN=true; shift ;;
+    *) echo "Unknown arg $1"; exit 2 ;;
+  esac
+done
+
+if [ -z "$VAULT_PATH" ] || [ -z "$K8S_SECRET" ]; then
+  echo "Usage: $0 --vault-path <vault-path> --k8s-secret <k8s-secret> [--namespace <ns>] [--dry-run]" >&2
+  exit 2
+fi
+
+if ! command -v vault >/dev/null 2>&1; then
+  echo "vault CLI not found in PATH" >&2
+  exit 3
+fi
+
+echo "Reading Vault path: $VAULT_PATH"
+# read raw data from kv v2; handle both /data/<path> and plain path
+VAULT_JSON="$(vault kv get -format=json "${VAULT_PATH}" 2>/dev/null || vault kv get -format=json "data/${VAULT_PATH}" 2>/dev/null || true)"
+if [ -z "$VAULT_JSON" ]; then
+  echo "Failed to read Vault path ${VAULT_PATH}" >&2
+  exit 4
+fi
+
+# Extract data map (works with kv v2 structure)
+DATA_JSON="$(echo "$VAULT_JSON" | jq -r '.data.data // .data')"
+if [ -z "$DATA_JSON" ] || [ "$DATA_JSON" = "null" ]; then
+  echo "No key data found at Vault path" >&2
+  exit 5
+fi
+
+YAML_TMP=$(mktemp)
+echo "Preparing k8s secret manifest for $K8S_SECRET in namespace $NAMESPACE"
+# Build kubectl --from-literal args safely by writing a yaml secret
+echo "apiVersion: v1
+kind: Secret
+metadata:
+  name: ${K8S_SECRET}
+  namespace: ${NAMESPACE}
+type: Opaque
+stringData:" > "$YAML_TMP"
+
+echo "$DATA_JSON" | jq -r 'to_entries[] | "  \(.key): \(.value|tostring)"' >> "$YAML_TMP"
+
+if [ "$DRY_RUN" = "true" ]; then
+  echo "DRY RUN - secret manifest:"
+  cat "$YAML_TMP"
+  rm -f "$YAML_TMP"
+  exit 0
+fi
+
+kubectl apply -f "$YAML_TMP"
+echo "Patched Kubernetes secret ${K8S_SECRET} in ${NAMESPACE}"
+rm -f "$YAML_TMP"
+exit 0
+
*** End Patch
*** Begin Patch
*** Add File: .github/workflows/rotate_secrets.yml
+name: Rotate Vault → K8s secrets
+
+on:
+  workflow_dispatch:
+  schedule:
+    - cron: '0 3 * * *' # nightly at 03:00 UTC
+
+jobs:
+  rotate:
+    runs-on: ubuntu-latest
+    steps:
+      - uses: actions/checkout@v4
+      - name: Set up Vault CLI
+        run: sudo apt-get update && sudo apt-get install -y jq
+      - name:*](#)

