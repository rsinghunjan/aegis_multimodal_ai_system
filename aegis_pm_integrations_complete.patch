*** Begin Patch
*** Add File:integrations/monday_zoho/connector.py
+#!/usr/bin/env python3
+"""
+Helper library to update Monday.com boards (GraphQL) and Zoho Projects (REST).
+Usage examples are in service.py which exposes a small HTTP endpoint for event-driven updates.
+
+Environment variables:
+ - MONDAY_API_TOKEN
+ - MONDAY_BOARD_ID
+ - ZOHO_API_TOKEN
+ - ZOHO_ORG_ID
+ - ZOHO_PROJECT_ID
+
+This module keeps implementation minimal and safe: it does not store secrets and expects them
+to be provided via k8s Secrets mounted as env vars.
+"""
+import os
+import requests
+import logging
+
+logger = logging.getLogger("aegis.pm.connector")
+logging.basicConfig(level=logging.INFO)
+
+MONDAY_API = "https://api.monday.com/v2"
+ZOHO_BASE = "https://projectsapi.zoho.com/restapi"
+
+def update_monday_item(board_id: str, item_name: str, column_values: dict):
+    token = os.environ.get("MONDAY_API_TOKEN")
+    if not token:
+        raise RuntimeError("MONDAY_API_TOKEN not configured")
+    headers = {"Authorization": token, "Content-Type": "application/json"}
+    # Create an item (or update by searching first) - simple create for demo
+    cols_json = json_encode_column_values(column_values)
+    query = f'mutation {{ create_item (board_id:{board_id}, item_name: "{item_name}", column_values: "{cols_json}") {{ id }} }}'
+    resp = requests.post(MONDAY_API, json={"query": query}, headers=headers, timeout=10)
+    resp.raise_for_status()
+    return resp.json()
+
+def json_encode_column_values(d: dict) -> str:
+    # monday expects a JSON string for column_values, with quotes escaped
+    import json
+    return json.dumps(d).replace('"', '\\"')
+
+def update_zoho_task(project_id: str, task_name: str, notes: str):
+    token = os.environ.get("ZOHO_API_TOKEN")
+    org = os.environ.get("ZOHO_ORG_ID")
+    if not token or not org:
+        raise RuntimeError("ZOHO_API_TOKEN or ZOHO_ORG_ID not configured")
+    url = f"{ZOHO_BASE}/portal/{org}/projects/{project_id}/tasks/"
+    headers = {"Authorization": f"Zoho-oauthtoken {token}", "Content-Type": "application/json"}
+    payload = {"name": task_name, "notes": notes}
+    r = requests.post(url, json=payload, headers=headers, timeout=10)
+    r.raise_for_status()
+    return r.json()
+
*** End Patch
*** Begin Patch
*** Add File:integrations/monday_zoho/service.py
+#!/usr/bin/env python3
+"""
+A small Flask service that receives promotion events and updates PM tools.
+Expose endpoint /pm/event which accepts JSON payload:
+{
+  "type":"promotion_complete",
+  "artifact":"aegis-model",
+  "manifest_s3":"s3://bucket/.../manifest.json",
+  "evidence_s3":"s3://bucket/.../evidence.tgz",
+  "issue": {"type":"jira"|"github","id":"PROJECT-123" or PR #}
+}
+
+The service will:
+ - create/update a Monday item on configured board
+ - create a Zoho task in configured project (optional)
+ - return 200 on success
+"""
+import os, json
+from flask import Flask, request, jsonify
+from integrations.monday_zoho.connector import update_monday_item, update_zoho_task
+
+app = Flask("aegis-pm-connector")
+
+MONDAY_BOARD = os.environ.get("MONDAY_BOARD_ID")
+ZOHO_PROJECT = os.environ.get("ZOHO_PROJECT_ID")
+
+@app.route("/health", methods=["GET"])
+def health():
+    return jsonify({"status":"ok"})
+
+@app.route("/pm/event", methods=["POST"])
+def pm_event():
+    j = request.get_json(force=True)
+    typ = j.get("type")
+    if typ not in ("promotion_complete","promotion_failed"):
+        return jsonify({"error":"unsupported type"}), 400
+    artifact = j.get("artifact","artifact")
+    manifest = j.get("manifest_s3","")
+    evidence = j.get("evidence_s3","")
+    title = f"Promotion: {artifact}"
+    notes = f"Manifest: {manifest}\nEvidence: {evidence}\nEvent: {typ}"
+    # Monday
+    try:
+        if MONDAY_BOARD:
+            col_vals = {"text": notes}
+            update_monday_item(MONDAY_BOARD, title, col_vals)
+    except Exception as e:
+        app.logger.exception("monday update failed: %s", e)
+    # Zoho
+    try:
+        if ZOHO_PROJECT:
+            update_zoho_task(ZOHO_PROJECT, title, notes)
+    except Exception as e:
+        app.logger.exception("zoho update failed: %s", e)
+    return jsonify({"status":"ok"})
+
+if __name__ == "__main__":
+    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", "8082")))
+
*** End Patch
*** Begin Patch
*** Add File:integrations/monday_zoho/deployment.yaml
+apiVersion: apps/v1
+kind: Deployment
+metadata:
+  name: aegis-pm-connector
+  namespace: aegis
+spec:
+  replicas: 1
+  selector:
+    matchLabels:
+      app: aegis-pm-connector
+  template:
+    metadata:
+      labels:
+        app: aegis-pm-connector
+    spec:
+      containers:
+        - name: connector
+          image: registry.example.com/aegis/pm-connector:latest
+          env:
+            - name: MONDAY_BOARD_ID
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: MONDAY_BOARD_ID
+            - name: MONDAY_API_TOKEN
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: MONDAY_API_TOKEN
+            - name: ZOHO_API_TOKEN
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: ZOHO_API_TOKEN
+            - name: ZOHO_ORG_ID
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: ZOHO_ORG_ID
+            - name: ZOHO_PROJECT_ID
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: ZOHO_PROJECT_ID
+          ports:
+            - containerPort: 8082
+---
+apiVersion: v1
+kind: Service
+metadata:
+  name: aegis-pm-connector
+  namespace: aegis
+spec:
+  selector:
+    app: aegis-pm-connector
+  ports:
+    - port: 8082
+      targetPort: 8082
+
*** End Patch
*** Begin Patch
*** Add File:scripts/github/migrate_to_github.py
+#!/usr/bin/env python3
+"""
+Migration helper to create GitHub issues for existing tasks from CSV/JSON and link evidence.
+Usage:
+  python3 scripts/github/migrate_to_github.py --input tasks.json --repo owner/repo
+
+Input format (JSON array):
+[
+  {"title":"Task 1","body":"desc","labels":["promotion"],"evidence":"s3://..."},
+  ...
+]
+"""
+import argparse, json, os
+from github import Github
+
+def main():
+    p = argparse.ArgumentParser()
+    p.add_argument("--input", required=True)
+    p.add_argument("--repo", required=True)
+    args = p.parse_args()
+    token = os.environ.get("GITHUB_TOKEN")
+    if not token:
+        raise RuntimeError("Set GITHUB_TOKEN env")
+    gh = Github(token)
+    repo = gh.get_repo(args.repo)
+    items = json.load(open(args.input))
+    for it in items:
+        title = it.get("title")
+        body = it.get("body","") + "\n\nEvidence: " + it.get("evidence","")
+        labels = it.get("labels",[])
+        issue = repo.create_issue(title=title, body=body, labels=labels)
+        print("Created issue", issue.number)
+
+if __name__=="__main__":
+    main()
+
*** End Patch
*** Begin Patch
*** Add File:scripts/github/create_project_board.py
+#!/usr/bin/env python3
+"""
+Create a GitHub project board and basic columns for tracking Aegis promotions.
+Requires GITHUB_TOKEN and GITHUB_REPO env (owner/repo).
+"""
+import os
+from github import Github
+
+repo_name = os.environ.get("GITHUB_REPO")
+token = os.environ.get("GITHUB_TOKEN")
+if not repo_name or not token:
+    print("Set GITHUB_REPO and GITHUB_TOKEN")
+    raise SystemExit(1)
+
+gh = Github(token)
+owner, repo = repo_name.split("/")
+repository = gh.get_repo(f"{owner}/{repo}")
+project = repository.create_project("Aegis Promotions", body="Board for Aegis model promotions")
+print("Created project:", project.name)
+for col in ["Backlog","In Progress","Ready for Promotion","Promoted","Blocked"]:
+    project.create_column(col)
+    print("Created column", col)
+
*** End Patch
*** Begin Patch
*** Add File:ui/dashboard/package.json
+{
+  "name": "aegis-dashboard",
+  "version": "0.1.0",
+  "private": true,
+  "dependencies": {
+    "react": "^18.2.0",
+    "react-dom": "^18.2.0",
+    "axios": "^1.4.0"
+  },
+  "scripts": {
+    "start": "parcel src/index.html --port 3000",
+    "build": "parcel build src/index.html --public-url ./"
+  },
+  "devDependencies": {
+    "parcel": "^2.9.3"
+  }
+}
+
*** End Patch
*** Begin Patch
*** Add File:ui/dashboard/src/index.html
+<!doctype html>
+<html>
+  <head>
+    <meta charset="utf-8" />
+    <title>Aegis Dashboard</title>
+  </head>
+  <body>
+    <div id="root"></div>
+    <script src="./index.js"></script>
+  </body>
+</html>
+
*** End Patch
*** Begin Patch
*** Add File:ui/dashboard/src/index.js
+import React from "react";
+import { createRoot } from "react-dom/client";
+import App from "./App";
+
+const container = document.getElementById("root");
+const root = createRoot(container);
+root.render(<App />);
+
*** End Patch
*** Begin Patch
*** Add File:ui/dashboard/src/App.js
+import React, { useState, useEffect } from "react";
+import axios from "axios";
+
+export default function App(){
+  const [artifacts, setArtifacts] = useState([]);
+  useEffect(() => {
+    axios.get("/api/registry/artifacts").then(r => setArtifacts(r.data)).catch(e => console.error(e));
+  },[]);
+  return (
+    <div style={{padding:20,fontFamily:"sans-serif"}}>
+      <h1>Aegis Promotion Dashboard</h1>
+      <p>Shows recent artifacts and promotion status (linked to evidence).</p>
+      <table border="1" cellPadding="8" style={{borderCollapse:"collapse",width:"100%"}}>
+        <thead><tr><th>Artifact</th><th>SHA256</th><th>Created</th><th>Evidence</th></tr></thead>
+        <tbody>
+          {artifacts.map(a => (
+            <tr key={a.artifact_id}>
+              <td>{a.manifest?.artifact || a.artifact_id}</td>
+              <td style={{fontFamily:"monospace"}}>{a.manifest?.sha256?.slice(0,12)}</td>
+              <td>{new Date((a.registered_at||0)*1000).toLocaleString()}</td>
+              <td>{a.evidence_s3 ? <a href={`https://s3.console.aws.amazon.com/s3/object/${a.evidence_s3.replace("s3://","")}`} target="_blank" rel="noreferrer">evidence</a> : "â€”"}</td>
+            </tr>
+          ))}
+        </tbody>
+      </table>
+    </div>
+  );
+}
+
*** End Patch
*** Begin Patch
*** Add File:ui/dashboard/README.md
+# Aegis Promotion Dashboard
+
+This is a tiny React dashboard that calls a backend API at /api/registry/artifacts to list registered artifacts and evidence links.
+
+Development:
+- cd ui/dashboard
+- npm install
+- npm start
+
+In production, build and host assets via a static server and proxy /api requests to registry backend (aegis platform's Mongo/Microservice).
+
*** End Patch
*** Begin Patch
*** Add File:integrations/dashboard_backend/app.py
+#!/usr/bin/env python3
+"""
+Tiny backend that proxies to MongoDB registry to provide data for the dashboard.
+Requires MONGO_URI env var.
+"""
+from flask import Flask, jsonify
+from pymongo import MongoClient
+import os
+
+app = Flask("aegis-dashboard-backend")
+MONGO_URI = os.environ.get("MONGO_URI","mongodb://mongo.aegis.svc:27017")
+client = MongoClient(MONGO_URI)
+db = client['aegis']
+
+@app.route("/api/registry/artifacts")
+def artifacts():
+    docs = list(db.artifacts.find().sort("registered_at",-1).limit(50))
+    for d in docs:
+        d["_id"] = str(d["_id"])
+    return jsonify(docs)
+
+@app.route("/health")
+def health():
+    return jsonify({"status":"ok"})
+
+if __name__=="__main__":
+    app.run(host="0.0.0.0", port=8000)
+
*** End Patch
*** Begin Patch
*** Add File:integrations/dashboard_backend/deployment.yaml
+apiVersion: apps/v1
+kind: Deployment
+metadata:
+  name: aegis-dashboard-backend
+  namespace: aegis
+spec:
+  replicas: 1
+  selector:
+    matchLabels:
+      app: aegis-dashboard-backend
+  template:
+    metadata:
+      labels:
+        app: aegis-dashboard-backend
+    spec:
+      containers:
+        - name: backend
+          image: registry.example.com/aegis/dashboard-backend:latest
+          env:
+            - name: MONGO_URI
+              valueFrom:
+                secretKeyRef:
+                  name: aegis-required-secrets
+                  key: MONGO_URI
+          ports:
+            - containerPort: 8000
+---
+apiVersion: v1
+kind: Service
+metadata:
+  name: aegis-dashboard-backend
+  namespace: aegis
+spec:
+  selector:
+    app: aegis-dashboard-backend
+  ports:
+    - port: 8000
+      targetPort: 8000
+
*** End Patch
*** Begin Patch
*** Add File:docs/MIGRATION_RUNBOOK.md
+# Aegis -> PM Migration Runbook (Monday/Zoho integration & GitHub Issues migration)
+
+This runbook outlines steps to:
+- wire Aegis events into Monday.com and Zoho Projects
+- migrate existing project items into GitHub Issues & Projects
+- deploy a small dashboard for PM visibility
+
+Prerequisites
+- Kubernetes cluster with aegis namespace
+- aegis-required-secrets created (GitHub token, Slack/Teams webhooks, Jira creds, Monday/Zoho creds)
+- Docker registry access to push the small integration images
+- Admin access to Monday.com, Zoho Projects, GitHub org/repo, Jira (if used)
+
+Steps
+1) Deploy PM connector (Monday/Zoho)
+ - Build and push image for integrations/monday_zoho (or use local Python)
+ - kubectl apply -f integrations/monday_zoho/deployment.yaml
+ - Confirm service is healthy: kubectl -n aegis get svc aegis-pm-connector
+ - Test endpoint:
+   curl -X POST http://$(kubectl -n aegis get svc aegis-pm-connector -o jsonpath='{.status.loadBalancer.ingress[0].ip}')/pm/event -H "Content-Type: application/json" -d '{"type":"promotion_complete","artifact":"demo","manifest_s3":"s3://...","evidence_s3":"s3://..."}'
+
+2) Migrate tasks to GitHub Issues
+ - Prepare tasks.json array file of items to import
+ - Ensure GITHUB_REPO and GITHUB_TOKEN env are set
+ - python3 scripts/github/migrate_to_github.py --input tasks.json --repo owner/repo
+ - Create project board:
+   export GITHUB_REPO=owner/repo && export GITHUB_TOKEN=XXX
+   python3 scripts/github/create_project_board.py
+
+3) Deploy dashboard
+ - Build and push integrations/dashboard-backend image and ui/dashboard static build
+ - kubectl apply -f integrations/dashboard_backend/deployment.yaml
+ - Serve ui assets via an ingress or static svc pointing to the built files
+ - Open dashboard and confirm artifacts appear
+
+4) Configure webhook receiver integration
+ - Deploy integrations/webhook_receiver (edit secrets for GitHub/Jira/Slack/Teams)
+ - Configure Argo and CI to POST promotion events to /notify endpoint
+ - Example payload: { "type":"promotion_complete", "artifact":"x", "manifest_s3":"s3://...", "evidence_s3":"s3://...", "pr_number": 12 }
+
+5) Validate end-to-end
+ - Trigger a promotion (use scripts/smoke/full_promotion_smoke.sh)
+ - Confirm Monday item and/or Zoho task created
+ - Confirm GitHub release/comment created via promotion_notify_and_release workflow
+ - Confirm Slack/Teams messages posted
+
+6) Flip Gatekeeper enforcement (after audit)
+ - Follow docs/GATEKEEPER_FLIP_CHECKLIST.md to flip constraints from dryrun to deny
+
+Rollback & Troubleshooting
+- If connector fails to create items, inspect logs: kubectl -n aegis logs deploy/aegis-pm-connector
+- If GitHub rate-limited, use authenticated GitHub App with higher quotas
+- If Monday GraphQL errors occur, validate board ID and API token scopes
+
*** End Patch
*** End Patch
